{
	"name": "KNLMeansCL",
	"type": "VSPlugin",
	"description": "OpenCL Non-local means denoising",
	"identifier": "com.Khanattila.KNLMeansCL",
	"github": "https://github.com/Khanattila/KNLMeansCL",
	"file_definitions": {
		"test-filter-0.vpy": {
			"path": "{TESTDIR}",
			"encoding": "text/utf-8",
			"data": "import vapoursynth as vs\ncore = vs.core\ncore.std.LoadPlugin('{TESTDIR}/{PLUGIN_FILENAME}')\nc = core.std.BlankClip(format=vs.YUV420P8,width=320,height=240,length=10)\nc = core.knlm.KNLMeansCL(c)\nc.set_output(0)\n"
		}
	},
	"tests": [
		{
			"name": "test-filter-0",
			"create_files": [
				"test-filter-0.vpy"
			],
			"commands": [
				{
					"cwd": "{TESTDIR}",
					"cmd": [
						"{VSPIPE}",
						"test-filter-0.vpy",
						"--"
					]
				}
			]
		}
	],
	"runtime_dependencies": {
		"boost": {
			"versions": {
				"1.90.0": {
					"version": "1.90.0",
					"published": "2025-12-10T16:10:51Z",
					"source": "https://archives.boost.io/release/1.90.0/source/boost_1_90_0.tar.gz",
					"hash": "5e93d582aff26868d581a52ae78c7d8edf3f3064742c6e77901a1f18a437eea9",
					"filename": "boost_1_90_0.tar.gz",
					"build": {
						".*": {
							"commands": [
								{
									"cmd": [
										"tar",
										"xzf",
										"{DL_FILENAME}"
									]
								},
								{
									"flags": {
										"CFLAGS": "-fPIC",
										"LDFLAGS": "-fPIC"
									},
									"cwd": "{DL_DIRECTORY}",
									"cmd": [
										"./bootstrap.sh",
										"--prefix={WORKSPACEDIR}",
										"--with-libraries=filesystem,system"
									]
								},
								{
									"flags": {
										"CFLAGS": "-fPIC",
										"LDFLAGS": "-fPIC"
									},
									"cwd": "{DL_DIRECTORY}",
									"cmd": [
										"./b2",
										"link=static",
										"cxxflags=-fPIC",
										"cflags=-fPIC",
										"install"
									]
								}
							]
						}
					}
				}
			}
		},
		"OpenCL-Headers": {
			"versions": {
				"v2025.07.22": {
					"version": "v2025.07.22",
					"published": "2025-07-22T20:26:14Z",
					"source": "https://github.com/KhronosGroup/OpenCL-Headers/archive/refs/tags/v2025.07.22.tar.gz",
					"hash": "98f0a3ea26b4aec051e533cb1750db2998ab8e82eda97269ed6efe66ec94a240",
					"filename": "OpenCL-Headers-2025.07.22.tar.gz",
					"build": {
						".*": {
							"commands": [
								{
									"cmd": [
										"tar",
										"xzf",
										"{DL_FILENAME}"
									]
								},
								{
									"flags": {
										"CFLAGS": "-fPIC",
										"LDFLAGS": "-fPIC"
									},
									"cwd": "{DL_DIRECTORY}",
									"cmd": [
										"cmake",
										"-DCMAKE_INSTALL_PREFIX:PATH={WORKSPACEDIR}",
										"-DBUILD_SHARED_LIBS=OFF",
										"-DCMAKE_POSITION_INDEPENDENT_CODE=ON",
										"-B",
										"._vsp_build/"
									]
								},
								{
									"cwd": "{DL_DIRECTORY}",
									"cmd": [
										"cmake",
										"--build",
										"._vsp_build",
										"--target",
										"install"
									]
								}
							]
						}
					}
				}
			},
			"github": "https://github.com/KhronosGroup/OpenCL-Headers"
		},
		"OpenCL-ICD-Loader": {
			"versions": {
				"v2025.07.22": {
					"version": "v2025.07.22",
					"published": "2025-07-22T20:30:55Z",
					"source": "https://github.com/KhronosGroup/OpenCL-ICD-Loader/archive/refs/tags/v2025.07.22.tar.gz",
					"hash": "dff7a0b11ad5b63a669358e3476e3dc889a4a361674e5b69b267b944d0794142",
					"filename": "OpenCL-ICD-Loader-2025.07.22.tar.gz",
					"build": {
						".*": {
							"commands": [
								{
									"cmd": [
										"tar",
										"xzf",
										"{DL_FILENAME}"
									]
								},
								{
									"flags": {
										"CFLAGS": "-fPIC",
										"LDFLAGS": "-fPIC"
									},
									"cwd": "{DL_DIRECTORY}",
									"cmd": [
										"cmake",
										"-DCMAKE_INSTALL_PREFIX:PATH={WORKSPACEDIR}",
										"-DCMAKE_PREFIX_PATH:PATH={WORKSPACEDIR}",
										"-DBUILD_SHARED_LIBS=OFF",
										"-DENABLE_SHARED=OFF",
										"-DCMAKE_POSITION_INDEPENDENT_CODE=ON",
										"-B",
										"._vsp_build/"
									]
								},
								{
									"cwd": "{DL_DIRECTORY}",
									"cmd": [
										"cmake",
										"--build",
										"._vsp_build",
										"--target",
										"install"
									]
								}
							]
						}
					}
				}
			},
			"github": "https://github.com/KhronosGroup/OpenCL-ICD-Loader"
		}
	},
	"releases": [
		{
			"version": "git:ca424fa",
			"published": "2023-01-05T11:12:03Z",
			"source": "https://github.com/Khanattila/KNLMeansCL/archive/ca424fa.tar.gz",
			"hash": "06afddba0217d5deebb5bdd625fb8251aa10ff196852653843bf59707b7c57ff",
			"filename": "KNLMeansCL-ca424fa91d1e16ec011f7db9c3ba0d1e76ed7850.tar.gz",
			"additional_files": {
				".*": [
					"{BUILDDIR}/{DL_DIRECTORY}/LICENSE",
					"{BUILDDIR}/{DL_DIRECTORY}/README.md",
					"{BUILDDIR}/{DL_DIRECTORY}/readme_build.txt"
				]
			},
			"build": {
				".*": {
					"commands": [
						{
							"cmd": [
								"tar",
								"xzf",
								"{DL_FILENAME}"
							]
						},
						{
							"cwd": "{DL_DIRECTORY}",
							"cmd": [
								"meson",
								"rewrite",
								"kwargs",
								"delete",
								"target",
								"knlmeanscl",
								"install_dir"
							]
						},
						{
							"cwd": "{DL_DIRECTORY}",
							"cmd": [
								"sed",
								"-i",
								"s/\\[opencl_dep, boost_dep\\]/[opencl_dep, boost_dep, declare_dependency(include_directories : include_directories(join_paths(get_option('prefix'),'include')))]/g",
								"meson.build"
							]
						},
						{
							"cwd": "{DL_DIRECTORY}",
							"cmd": [
								"sed",
								"-i",
								"s/dependency('boost', modules : \\['filesystem', 'system'\\])/dependency('boost', modules : ['filesystem'])/g",
								"meson.build"
							]
						},
						{
							"cwd": "{DL_DIRECTORY}",
							"env": {
								"BOOST_ROOT": "{WORKSPACEDIR}",
								"BOOST_INCLUDEDIR": "{WORKSPACEDIR}/include",
								"BOOST_LIBRARYDIR": "{WORKSPACEDIR}/lib"
							},
							"cmd": [
								"meson",
								"setup",
								"--prefix={WORKSPACEDIR}",
								"--libdir={WORKSPACEDIR}/lib",
								"build"
							]
						},
						{
							"cwd": "{DL_DIRECTORY}",
							"cmd": [
								"ninja",
								"-C",
								"build"
							]
						},
						{
							"cwd": "{DL_DIRECTORY}",
							"cmd": [
								"ninja",
								"-C",
								"build",
								"install"
							]
						}
					],
					"dependencies": [
						{
							"name": "boost",
							"version": "1.90.0"
						},
						{
							"name": "OpenCL-Headers",
							"version": "v2025.07.22"
						},
						{
							"name": "OpenCL-ICD-Loader",
							"version": "v2025.07.22"
						}
					]
				}
			},
			"buildtools_dependencies": {
				".*": [
					{
						"name": "cmake",
						"version": [
							">=",
							"3.24.0"
						]
					},
					{
						"name": "meson",
						"version": [
							">=",
							"0.60.0"
						]
					},
					{
						"name": "ninja",
						"version": [
							">=",
							"1.10.0"
						]
					}
				]
			},
			"release_files": {
				"linux-.*": [
					"{WORKSPACEDIR}/lib/libknlmeanscl.so"
				],
				"darwin-.*": [
					"{WORKSPACEDIR}/lib/libknlmeanscl.dylib"
				]
			},
			"tests": {
				".*": [
					"test-filter-0"
				]
			}
		}
	]
}
